# B站合集转收藏夹工具

🎯 一键将B站合集中的所有视频批量添加到你的收藏夹

## ✨ 功能特点

- 🚀 **批量转移**: 一次性将整个合集的所有视频添加到收藏夹
- 🔄 **智能重试**: 支持多种API端点，自动重试确保成功率
- 📊 **进度显示**: 实时显示转移进度和成功/失败统计
- 🛡️ **安全验证**: 内置cookies验证，确保账户安全
- 🔧 **调试模式**: 详细的错误信息和调试输出
- 📱 **多格式支持**: 支持多种B站合集URL格式

## 🔧 系统要求

- Python 3.6+
- requests 库
- 稳定的网络连接

## 📦 安装

### 1. 克隆项目
```bash
git clone [项目地址]
cd bilibili-collection-transfer
```

### 2. 安装依赖
```bash
pip install requests
```

### 3. 运行脚本
```bash
python bilibili_transfer.py
```

## 🚀 使用方法

### 第一步：获取B站Cookies

1. **登录B站**
   - 访问 [https://www.bilibili.com](https://www.bilibili.com)
   - 确保已经登录（右上角显示你的头像）

2. **打开开发者工具**
   - 按 `F12` 键
   - 或右键选择"检查"/"Inspect"

3. **获取Cookies**
   - 点击 "Console"（控制台）标签
   - 输入：`document.cookie`
   - 按回车执行，复制返回的整个字符串
   - 如果缺失 `SESSDATA`
   - 浏览器开发者工具 → Application/存储 → Cookies，找到之后补上去

### 第二步：运行脚本

```bash
python bilibili_transfer.py
```

### 第三步：选择功能

```
请选择功能:
1. 测试cookies是否有效
2. 执行合集转收藏夹
```

**建议先选择选项1测试cookies是否有效**

### 第四步：输入信息

如果cookies有效，选择选项2并按提示输入：

1. **B站Cookies**: 上面获取的完整cookie字符串
2. **合集URL**: 例如 `https://space.bilibili.com/627432065/lists/3836754?type=season`
3. **收藏夹URL**: 例如 `https://space.bilibili.com/309874814/favlist?fid=3125287314&ftype=create`

## 📋 支持的URL格式

### 合集URL格式
- `https://space.bilibili.com/用户ID/lists/合集ID?type=season`
- `https://space.bilibili.com/用户ID/channel/seriesdetail?sid=合集ID`

### 收藏夹URL格式
- `https://space.bilibili.com/用户ID/favlist?fid=收藏夹ID&ftype=create`

## 🔍 示例使用

```bash
$ python bilibili_transfer.py

============================================================
B站合集转收藏夹工具
============================================================

请选择功能:
1. 测试cookies是否有效
2. 执行合集转收藏夹

请输入选择 (1或2): 1

============================================================
B站Cookies测试工具
============================================================

请输入你的B站cookies: [你的cookies]

正在验证登录状态...
✅ 登录验证成功!
用户名: 你的用户名
UID: 12345678

🎉 Cookies有效！你可以使用主程序进行转移操作了。
```

## ⚠️ 注意事项

### 权限要求
- ✅ 只能添加到**你自己创建**的收藏夹
- ✅ 合集必须是**公开可访问**的
- ❌ 无法访问私有合集或他人的私有收藏夹

### 使用限制
- 🕐 脚本包含请求间隔，避免触发反爬虫限制
- 🔄 如果视频已在收藏夹中，会显示"添加失败"（这是正常的）
- 📶 确保网络连接稳定，大量视频转移需要时间

### 安全提醒
- 🔒 请勿分享你的cookies给他人
- ⏰ Cookies有时效性，过期后需要重新获取
- 🚫 遵守B站使用条款，适度使用

## 🐛 故障排除

### Cookies相关问题

#### 问题：❌ 登录验证失败
**解决方案：**
1. 确保已登录B站
2. 重新获取完整的cookies
3. 检查是否包含必要字段：`SESSDATA`、`DedeUserID`、`bili_jct`

#### 问题：cookies格式错误
**解决方案：**
- ✅ 正确格式：`SESSDATA=abc123; DedeUserID=12345; bili_jct=xyz789`
- ❌ 错误格式：`"SESSDATA=abc123"` (不要包含引号)

### API相关问题

#### 问题：获取合集视频失败
**解决方案：**
1. 检查合集URL是否正确
2. 确认合集是公开的
3. 合集可能是"视频列表"而非"合集"（脚本会自动尝试）

#### 问题：添加到收藏夹失败
**解决方案：**
1. 确认收藏夹URL正确
2. 确保是你自己的收藏夹
3. 检查收藏夹是否达到上限

## 📊 输出示例

```
============================================================
正在验证登录状态...
✅ 登录验证成功!
用户名: 示例用户
UID: 12345678
--------------------------------------------------
合集信息: 用户ID=627432065, 合集ID=3836754
收藏夹ID: 3125287314
--------------------------------------------------
正在获取合集 3836754 中的视频...
找到视频: 视频标题1 (BV1234567890)
找到视频: 视频标题2 (BV0987654321)
...
总共找到 25 个视频
--------------------------------------------------
开始将视频添加到收藏夹 3125287314...
[1/25] 成功添加: 视频标题1
[2/25] 成功添加: 视频标题2
[3/25] 添加失败: 视频标题3 - 已收藏
...
============================================================
操作完成!
成功转移 23 个视频到收藏夹
有 2 个视频转移失败
============================================================
```

